# Chef မိတ်ဆက်

Infrastructure as Code (IaC) အကြောင်း၊ network/systems automation အကြောင်းတွေကို စာရေးသူစိတ်ဝင်စားလို့လေ့လာရင်း ရသမျှအကုန်သိမ်းကြုံပြီးတော့လေ့လာလိုက်တာဖြင့် ထိုက်သင့်သလောက် ခရီးရောက်သင့်သလောက်ရောက်တယ်လို့ဆိုရမှာပါ။ စာတွေထပ်ပြီးတော့ မရေးဖြစ်ပေမယ့်လည်း လေ့လာစရာရှိတာတွေကိုဆက်ပြီးလေ့လာဖြစ်ခဲ့ပါတယ်။ အရင် IaC အပိုင်းတွေခွဲပြီးတော့ ရေးတဲ့ article တွေမှာဆို Vagrant တို့၊ Terraform တို့ အကြောင်းကို စပြီးမိတ်ဆက်ဖြစ်ခဲ့ဖူးပါတယ်။ အဲ့ဒီတုန်းက အပိုင်း(၄) အတွက် Ansible ကိုအသုံးပြုပြီး IaC ဘယ်လိုလုပ်လို့ရသလဲ ဆိုတာဆက်ပြီးတော့ မရေးဖြစ်ခဲ့ပါဘူး။ စာရေးသူရဲ့ လုပ်ငန်းခွင်မှာကလည်း Network Automation အတွက် Ansible ကို တွင်တွင်ကျယ်ကျယ်သုံးဖြစ်ခဲ့တဲ့အတွက် system automation အတွက် context ကောင်းကောင်းဖြစ်လာမယ့် use case မရှိခဲ့တာကြောင့်လည်းဖြစ်ပါတယ်။ အခုတော့ Linode မှာ VPS တစ်ခုနဲ့ WireGuard VPN server ကိုတည်ဆောက်တာဟာ အသင့်တော်ဆုံး Ansible ရဲ့ IaC workflow တစ်ခုအနေနဲ့ ဆက်ပြီးတော့ ရေးလို့ရသွားပါပြီ။ အဲ့ဒီတော့... IaC အပိုင်း(၄) ကိုမကြာခင်မှာ ဆက်ပြီးတော့တင်ပြသွားပါ့မယ်။ ကျန်တဲ့ အပိုင်းတွေကို မဖတ်ရသေးရင်တော့ အောက်ကလင့်တွေမှာ သွားရောက်ဖတ်ရှုလို့ရပါတယ်။&#x20;

{% embed url="https://my.itmatic101.com/automation/rough-edges-iac-part1" %}

{% embed url="https://my.itmatic101.com/automation/rough-edges-iac-part2" %}

{% embed url="https://my.itmatic101.com/automation/rough-edges-iac-part3" %}

အခု ဒီ article မှာတော့ အရင်တုန်းလုံးဝ မဆွေးနွေးဘူးသေးတဲ့ Chef အကြောင်းပဲဖြစ်ပါတယ်။ Infrastructure Automation မှာ တော်တော်လေးကို mature ဖြစ်တဲ့ configuration management tool တစ်ခုဖြစ်ရုံသာမက၊ Test Kitchen နဲ့ InSpec လိုမျိုး testing engine တွေတခါတည်းပါပြီးသားဖြစ်တဲ့ အတွက်အခြားထွေထွေထူးထူး ထပ်စောင်းရေးရတဲ့ code တွေမလိုပါဘူး။ ပိုပြီးတော့ စိတ်ဝင်စားဖို့ကောင်းတာက wrapper cookbook လို့ခေါ်တဲ့ဟာကိုသုံးပြီးတော့ community မှာရှိပြီးသား  recipes တွေကို ယူသုံးလို့ရတဲ့အတွက် အရမ်းကို အဆင်ပြေပါတယ်။ System ပိုင်းနဲ့ infrastructure ပိုင်းမှာတော့ Chef ဟာ Ansible ထက်သာတဲ့ အရာတွေအများကြီးရှိပါတယ်။ သို့သော် Ansible လိုမျိုး ssh enable ဖြစ်ရုံနဲ့ စပြီးတော့အလုပ်လုပ်လို့ရနိုင်မျိုးတော့လည်း မဟုတ်ပါ။ အသေးစိတ်ကို အောက်မှာဆက်ပြီးတော့ ရှင်းပါ့မယ်။&#x20;

Chef မှာဘာတွေရှိတယ်၊ ဘာတွေလုပ်လို့ရတယ်ဆိုတာတွေကို ဆက်မသွားခင် Chef မှာသုံးတဲ့ အသုံးအနှုန်းလေးတွေကို အရင်ဆုံးမိတ်ဆက်ပေးမှ သဘာဝကြပါလိမ့်မယ်။ နောက်မို့ဆိုရင်... စာရေးသူ ပြောတဲ့  kitchen တို့၊ recipe တို့၊ cookstyle တို့ကို ဘာတွေလဲဆိုပြီးတော့ မျက်စီလည်စရာရှိပါတယ်။&#x20;

**Chef Workstation** - အရင်တုန်းကတော့ ChefDK (Chef Development Kit)ဆိုပြီးတော့ခေါ်ပါတယ်၊ အခုတော့ Chef Workstation ရယ်လို့ ပြောင်းလဲခေါ်ဆိုလာခဲ့ကြပါတယ်။ ဒီတစ်ခုကိုတော့ ကိုယ့် computer ပေါ်မှာ install လုပ်ပြီး Chef server နဲ့တွဲသုံးလို့ရပါတယ်။ Chef server မပါပဲနဲ့လည်း Chef Workstation ကိုပဲ standalone အသုံးပြုချင်လည်း ရပါတယ်။ Chef Workstation ကို install မလုပ်ပဲနဲ့ chef code တွေကို စတင်ပြီးတော့ ရေးလို့မရပါဘူး။ ဥပမာ - ansible-playbook တွေကို run ဖို့အတွက် Ansible ကို ကိုယ့်စက်ပေါ်မှာအရင်ဆုံး install လုပ်ရသလိုပဲ၊ chef ကိုသုံးဖို့ရာအတွက် Chef Workstation ကိုကိုယ့်စက်မှာ ပထမဆုံး install လုပ်ရပါတယ်။&#x20;

**Chef Server** - Chef ကိုသုံးတဲ့အခါမှာ သူ့မှာပါတဲ့ feature တွေကိုအကုန်လုံးကို အသုံးပြုနိုင်ဖို့ရာ Chef server လိုပါတယ်။ ကိုယ်တိုင် self-hosted လုပ်လို့ရနိုင်သလို၊ Chef က hosted လုပ်ပေးထားတဲ့ [manage.chef.io](https://manage.chef.io/login) ကိုသုံးမယ်ဆိုလည်းရပါတယ်။ ကိုယ့်ရဲ့ environment ပေါ်မှာမူတည်ပြီးတော့ ရွေးချယ်အသုံးပြုနိုင်ပါတယ်။ Chef Workstation မှာ develop လုပ်ထားတဲ့ Chef code တွေဟာ ဒီအတိုင်းထားလိုက်ရင် locally execute လုပ်ဖို့နဲ့ Rake လိုမျိုး tool တွေကိုသုံးပြီးတော့ target machine တွေမှာသွား run ဖို့အတွက်တော့ အဆင်ပြေပါတယ်။ သို့သော်... Chef Server ကိုသုံးခြင်းအားဖြင့် Chef-Client node တွေကို bootstrap လုပ်ပြီးတော့ Chef Server မှာ register လုပ်ထားလို့ရပါတယ်။ နောင်အခါ လိုအပ်တဲ့ configuration တွေကိုထပ်ပေါင်းထည့်ချင်ရင်လည်း ရှိပြီးတော့ machine state တွေကို Chef Server က manage လုပ်နိုင်စွမ်းရှိပါတယ်။ ဒီတစ်ခုဟာဖြင့် Ansible နဲ့ လုံးဝကို ကွဲထွက်သွားတဲ့ Chef ရဲ့ ထူးခြားချက်တစ်ခုပါ။&#x20;

**Chef-Client** - Chef-client ဆိုတာကတော့ Chef က manage လုပ်တဲ့ node တွေကိုခေါ်ဆိုခြင်းဖြစ်ပါတယ်။ အထက်မှာပြောသလိုမျိုး node အသစ်တစ်ခုကို Chef နဲ့ manage လုပ်ဖို့ရာအတွက် Chef Server နဲ့ bootstrap လုပ်ရပါတယ်။ အဲ့ဒီလိုမျိုး လုပ်တဲ့အခါမှာ agent ကို Chef-client node တွေပေါ်မှာ install လုပ်တယ်။ ဒီ့အတွက်လည်း Chef Server ဟာအဲ့ဒီ chef-client node တွေအတွက် state-aware ဖြစ်တာပါ။ ဒါ့ကြောင့် test and repair လိုမျိုး ကိစ္စတွေဟာ Chef မှာအလွယ်တကူ လုပ်ဆောင်နိုင်တာပဲဖြစ်ပါတယ်။&#x20;

